CONTRACT_INTERFACE_THIGH_V0.md

Contract Layer — Interface Definition

0. Scope & Authority

Layer: Contract (Interface)

Measurement: THIGH (Upper Leg Circumference)

Semantic Anchor: SEMANTIC_DEFINITION_THIGH_VNEXT.md

Applies To:

thigh_v0 (초기 구현)

THIGH 계열 이후 버전

본 문서는 THIGH 의미론을 코드 인터페이스로 봉인한다.
계산 방법, 단면 선택, 검증 기준, 판단 로직은 포함하지 않는다.

1. Contract Role Statement

Contract Layer의 역할은 다음 하나다.

Semantic Definition에서 규정한 THIGH의 의미가
코드 입·출력에서 어떻게 표현되어야 하는지를 명확히 한다.

Contract는:

의미 해석 ❌ (Judgment 아님)

계산 설명 ❌ (Geometric 아님)

결과 평가 ❌ (Validation 아님)

2. Input Contract (입력 계약)
2.1 Required Inputs
항목	타입	의미
verts	float32[N, 3]	3D 인체 메시 정점 좌표
measurement_key	Enum	THIGH

measurement_key는 THIGH 단일 값만 허용된다.

2.2 Unit Assumption (필수 전제)

입력 좌표는 meters 단위여야 한다.

Geometry는 단위 추론·보정 금지

단위 위반은:

❌ Geometry Error 아님

✅ Semantic/Contract 위반

3. Output Contract (출력 계약)
필드	타입	의미
circumference_m	float | NaN	THIGH 둘레 (meters) 또는 Undefined
section_id	string	선택된 단면 식별자
method_tag	string	측정 방법 태그
warnings	list[string]	주의 신호 목록
4. Undefined vs Error vs Warning (핵심 계약)
4.1 Undefined (NaN)

NaN은 Error가 아니다.

NaN은 다음을 의미한다.

THIGH 측정이 정의되지 않음

상부 다리 영역에서 의미 있는 폐곡선 단면이 성립하지 않음

NaN이 허용되는 대표 상황

사지 형상이 불충분

상부 다리 영역 후보 부재

영역 모호로 대표 단면 성립 불가

→ 이는 Semantic 경계 표현이다.

4.2 Error (Exception)

Error는 계약 또는 시스템 실패를 의미한다.

상황	처리
verts shape 불일치	Exception 허용
필수 입력 누락	Exception 허용
내부 연산 불가능	Exception 허용
4.3 Warning

Warning은 결과를 부정하지 않는다.

대표 Warning 예

UNIT_FAIL

DEGEN_FAIL

REGION_AMBIGUOUS

LEG_REGION_UNCERTAIN

Warning은:

결과를 차단하지 않음

Judgment Layer 입력 신호로만 사용

5. section_id Contract

section_id는 재현성 보장용 계약 식별자다.

요구사항:

동일 입력 → 동일 section_id

상부 다리 후보 단면을 식별할 수 있어야 함

문자열(JSON 직렬화 허용)

6. Geometry Layer: Allowed & Forbidden
Allowed

NaN 반환

Warning 추가

내부 계산 방식 변경(계약 유지 조건)

Forbidden

hip/knee landmark 추론

단위 자동 보정

Undefined를 Error로 승격

Warning 은닉

의미론적 판단 수행

7. Contract Stability Declaration

본 문서는 THIGH Contract v0로 봉인된다.

Semantic이 유지되는 한 Contract는 유지된다.

8. Boundary Statement

본 문서는 다음을 포함하지 않는다.

단면 생성/선택 알고리즘

영역 추정 방식

Validation 메트릭

품질 판정

Contract는 오직 다음 질문에만 답한다.

“THIGH의 의미가 코드 인터페이스에서 어떻게 나타나야 하는가?”

9. Status

THIGH Contract Layer v0: Draft 완료

다음 단계: THIGH Geometric Layer v0